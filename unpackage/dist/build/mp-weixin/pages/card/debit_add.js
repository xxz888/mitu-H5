(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/card/debit_add"],{1228:function(n,e,o){"use strict";o.r(e);var t=o("2cff"),a=o.n(t);for(var c in t)"default"!==c&&function(n){o.d(e,n,(function(){return t[n]}))}(c);e["default"]=a.a},"2cff":function(n,e,o){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(){Promise.all([o.e("common/vendor"),o.e("components/w-compress/w-compress")]).then(function(){return resolve(o("c79e"))}.bind(null,o)).catch(o.oe)},a={components:{WCompress:t},data:function(){return{title:"绑定结算卡",step:3,camera:"https://daihuan.oss-cn-beijing.aliyuncs.com/shiming/ka.png",fullname:"",bankcard:"",bank_name:"",array:["南京人民银行支行","北京建设银行朝阳路支行"],provinceCity:"请选择开户行地点",phone:"",users:[]}},onShow:function(){this.api_getUser()},methods:{onSinngle:function(){var e=this;n.chooseImage({count:1,success:function(n){e.$refs.wCompress.start(n.tempFilePaths[0],{pixels:1e5,quality:.5,type:"png",base64:!1}).then((function(n){e.single=n,e.savePicture(n)})).catch((function(n){console.log(n)}))}})},savePicture:function(e){for(var o=e.split(","),t=atob(o[1]),a=new ArrayBuffer(t.length),c=new Uint8Array(a),i=0;i<t.length;i++)c[i]=t.charCodeAt(i);var r=new Blob([a],{type:"application/octet-stream"}),s=URL.createObjectURL(r);console.log("url===",s);var l=this;l.camera=s;var u={filePath:s};l.$api.api_ocrUploadBankcard(u).then((function(e){var o=JSON.parse(e.data);console.log("r.code",o),0==o.code?(l.bankcard=o.data.card_number,l.bank_name=o.data.bank_name):n.showToast({title:"解析失败",icon:"none"})})).catch((function(e){n.showToast({title:"网络链接失败",icon:"none"})}))},api_getUser:function(){var e=this,o={id:n.getStorageSync("users").id};this.$meapi.api_getUser(o).then((function(n){console.log("首页获取个人信息成功成功",n.data.selfLevel),0==n.code&&(e.fullname=n.data.fullname)})).catch((function(e){console.log("api_changeAlipay失败",e),n.showToast({title:"网络链接失败",icon:"none"})}))},openCamera:function(){var e=this,o=this;console.log("上传图片"),n.chooseImage({count:1,success:function(t){console.log("res.tempFilePaths[0]",t.tempFilePaths[0]),e.camera=t.tempFilePaths[0];var a={filePath:t.tempFilePaths[0]};o.$api.api_ocrUploadBankcard(a).then((function(e){console.log("api_ocrUploadA",e.data);var t=JSON.parse(e.data);0==t.code&&"借记卡"==t.data.card_type?(o.bankcard=t.data.card_number,o.bank_name=t.data.bank_name):"借记卡"!=t.data.card_type?n.showToast({title:"请识别借记卡",icon:"none"}):n.showToast({title:"识别失败",icon:"none"})})).catch((function(e){n.showToast({title:"网络链接失败",icon:"none"})}))}})},handleGetRegion:function(n){console.log(n),this.provinceCity="".concat(n[0].name).concat(n[1].name)},bindDebitCard:function(){console.log("123456");var e=this;if(console.log(n.getStorageSync("users")),console.log(e.bankcard),console.log(e.provinceCity),console.log(e.phone),e.bankcard.length<6||e.provinceCity.length<2||11!=e.phone.length)n.showToast({title:"请先完善信息",icon:"none"});else{var o={fullname:n.getStorageSync("users").fullname,bankName:e.bank_name,bankcard:e.bankcard,provinceCity:e.provinceCity,phone:e.phone};e.$api.api_bindBankcard(o).then((function(e){console.log("api_bindBankcard",e),0==e.code?n.navigateBack({}):n.showToast({title:e.message,icon:"none"})})).catch((function(e){console.log("err=",e),n.showToast({title:"网络链接失败",icon:"none"})}))}},tuerbandcard:function(){n.reLaunch({url:"/pages/index/index"})},back:function(){n.navigateBack()}}};e.default=a}).call(this,o("543d")["default"])},"5b29":function(n,e,o){"use strict";o.d(e,"b",(function(){return a})),o.d(e,"c",(function(){return c})),o.d(e,"a",(function(){return t}));var t={pickRegions:function(){return Promise.all([o.e("common/vendor"),o.e("components/pick-regions/pick-regions")]).then(o.bind(null,"dcad"))},wCompress:function(){return Promise.all([o.e("common/vendor"),o.e("components/w-compress/w-compress")]).then(o.bind(null,"c79e"))}},a=function(){var n=this,e=n.$createElement;n._self._c},c=[]},7195:function(n,e,o){"use strict";var t=o("819e"),a=o.n(t);a.a},"819e":function(n,e,o){},e4677:function(n,e,o){"use strict";(function(n){o("3335");t(o("66fd"));var e=t(o("fb57"));function t(n){return n&&n.__esModule?n:{default:n}}n(e.default)}).call(this,o("543d")["createPage"])},fb57:function(n,e,o){"use strict";o.r(e);var t=o("5b29"),a=o("1228");for(var c in a)"default"!==c&&function(n){o.d(e,n,(function(){return a[n]}))}(c);o("7195");var i,r=o("f0c5"),s=Object(r["a"])(a["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],i);e["default"]=s.exports}},[["e4677","common/runtime","common/vendor"]]]);